{% extends 'base.html' %}


{% block head_content %}
<link href='https://fonts.googleapis.com/css?family=Didact Gothic' rel='stylesheet'>
<script src="https://cdn.jsdelivr.net/npm/@turf/turf@5/turf.min.js"></script>

<!-- Map stuff -->

<meta charset='utf-8' />
<title>Display a map</title>
<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
<script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.js'></script>
<link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.0.0/mapbox-gl.css' rel='stylesheet' />
<!-- end map stuff -->

<script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
<style>

body { 
      margin:0; 
      padding:0; 
      font-family: 'Didact Gothic';
}

.main-content {
  position: relative;
  height: 100vh
}

#map { 
        position:inherit; 
        top:0; 
        bottom:0; 
        width:100%;
    }


/* Style the tab */
.tab {
  overflow: hidden;
  /*border: 1px solid #ccc;*/
  /*background-color: #f1f1f1;*/
  border-bottom: 10px;
}

/* Style the buttons inside the tab */
.tab button {
  background-color: inherit;
  float: left;
  border: 1px solid #ccc;
  border-radius: 10px 10px 0 0;
  outline: none;
  cursor: pointer;
  padding: 14px 16px;
  transition: 0.3s;
  font-size: 17px;
  color: #ccc;
}

/* Change background color of buttons on hover */
.tab button:hover {
  /*background-color: #ddd;*/
  background-color: #FFFFFF;
  color: black;

}

/* Create an active/current tablink class */
.tab button.active {
  border-bottom: 10px;
  z-index: 2;
  color: black;
}

/* Style the tab content */
.tabcontent {
  display: none;
  padding: 6px 12px;
  border: 1px solid #ccc;
  border-bottom: none;
  border-radius: 0 10px 0 0;
}

.tabcontent button {
  border: none;
  transition: 0.3s;
  font-size: 14px;
  color: black;
}

.tabcontent button:hover {
  background-color: black;
  color: white;
  border-radius: 10px;

}


.tabcontent li {
    font-size: 12px;
}

</style>

{% endblock %}

{% block content %}

<div class="main-content">

    <div class="container"> 

        <div id="tab-context">

            <div class="row">
                <h1>Collections</h1>
            </div>
            <div  id="top-content">
                <!-- make a button for each route name -->
                <div class="tab"  class="row">
                    {% for collection in current_user.collections %}
                        <button 
                          id="{{collection.collection_id}}" 
                          class="tablinks" 
                          onclick="openCollection(event, '{{collection.collection_name}}')"> 
                          {{collection.collection_name}}
                        </button>
                    {% endfor %}
                </div>  

                <div class="tabcontent-parent" class="row">


                        {% for collection in current_user.collections %}
                        <div id="{{collection.collection_name}}" class="tabcontent">
                          <!-- <h3>{{collection.collection_name}}</h3> -->
                          <ul>
                              {% for route in collection.routes %}
                                <button 
                                id="{{route.route_id}}" 
                                class="animate">
                                <i class="fa fa-play fa-sm" aria-hidden="true">
                                  
                                </i>   
                                  {{(route.route_name)}}
                                </button>

                                <br>
                                <!-- <div id="desc-{{route.route_id}}" class="route-details" style='display:none ;'> -->

                                <div id="desc-{{route.route_id}}" class="route-details">
                                    {% if route.route_geom.route_length != None %}
                                    <ul>
                                      <li id="length">Length: {{ (route.route_geom.route_length / 1.609) | round(2) }} mi</li>
                                      <li id="walking time">Duration: {{ (route.route_geom.route_length * 15) | round(0)}} min </li>
                                      

                                    </ul>
                                    
                                    {% endif %}
                                </div>

                              {% endfor %}

                          </ul>
                          
                        </div>
                        
                        {% endfor %}
                        <script>
                        function openCollection(evt, collectionName) {

                              var i, tabcontent, tablinks;
                              tabcontent = document.getElementsByClassName("tabcontent");

                              // hide all tabs - set display to none 
                              for (i = 0; i < tabcontent.length; i++) {
                                tabcontent[i].style.display = "none";
                              }

                              // deactivate all items in class tab 
                              tablinks = document.getElementsByClassName("tablinks");
                              
                              for (i = 0; i < tablinks.length; i++) {
                                tablinks[i].className = tablinks[i].className.replace(" active", "");

                              }

                              document.getElementById(collectionName).style.display = "block";
                        
                              evt.currentTarget.className += " active";
                        }
                        </script>

                    <div id='map' class="row">
                      <script type="text/javascript" src="static/script/collections_map.js"></script>
                    </div>

                </div>

            </div>

        </div>
</div>


{% endblock %}
























